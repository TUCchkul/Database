create database test;
use test;
create table order_data(
    cust_id int,
    order_id int,
    country varchar(50),
    state varchar(50)
);
insert into order_data values(1,100,'USA','Seattle');
insert into order_data values(2,101,'INDIA','UP');
insert into order_data values(2,103,'INDIA','Bihar');
insert into order_data values(4,108,'USA','WDC');
insert into order_data values(5,109,'UK','London');
insert into order_data values(4,110,'USA','WDC');
insert into order_data values(3,120,'INDIA','AP');
insert into order_data values(2,121,'INDIA','Goa');
insert into order_data values(1,131,'USA','Seattle');
insert into order_data values(6,142,'USA','Seattle');
insert into order_data values(7,150,'USA','Seattle');
select * from order_data;
#Use having clause
#write a query to find the country where only 1 order was placed
select country from order_data group by country having count(*)=1;
#write a query to find the country where only 1 order was placed
select country from order_data group by country having count(*)=4;

#where clause and group by clause->What should tbe the proper sequence?
#ans-> Where clause and then Group GROUP BY 

# How to use GROUP_CONCAT
# Query write a query to print distinct states present in the dataset for each country
select country, GROUP_CONCAT(state) as state_in_country from order_data group by country;
select country, group_concat(distinct state) as states_in_country from order_data group by country;
select country, group_concat(distinct state order by state desc) as state_in_country from order_data group by country;
select country, group_concat(distinct state order by state desc separator '<->') as state_country from order_data group by country;

create table employee(
    id int,
    name varchar(50),
    salary int
);
insert into employee values(1,'Shushank', 5000),(2,'Amit', 5500),(3,'Rahul', 7000),(4,'Rohit', 7000),(5,'Nitin', 5000),(6,'kul', 8000);
select * from employee;
